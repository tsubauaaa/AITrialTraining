## 課題10
音声データから感情を学習してみよう

### 課題1
音声周波数画像を特徴量としてCNNで感情を分類する
最初に講師から提示されたものから分類性能を上げてみる

#### [AITraining10-1.ipynb](./AITraining10-1.ipynb)
課題1を実施したプログラムコード

#### 結果

| No. |  精度  | やったこと、対応 |
| ---- | ---- | ---- |
| 1 | 0.56 | 最初に講師から提示されたもの|
| 2 | 0.70 | 音声データの20dB以下の部分をカット<br>音声データの特徴量をメルスペクトログラムにしてdBスケール化<br>ResNetの入力画像のチャネルを1にした |

※ No.2はNo.1から分類精度を上げるために追加対応した


* No.1の分類出力結果
    ```
                precision    recall  f1-score   support

            0       0.56      0.50      0.53        20
            1       0.62      0.86      0.72        37
            2       0.33      0.33      0.33        36
            3       0.44      0.35      0.39        40
            4       0.62      0.74      0.68        35
            5       0.69      0.46      0.55        52
            6       0.57      0.60      0.58        35
            7       0.59      0.65      0.62        34

        accuracy                           0.56       289
    macro avg       0.55      0.56      0.55       289
    weighted avg       0.56      0.56      0.55       289
    ```
* No.2の分類出力結果
    ```
                precision    recall  f1-score   support

            0       0.64      0.64      0.64        22
            1       0.74      0.76      0.75        38
            2       0.68      0.56      0.61        41
            3       0.51      0.49      0.50        39
            4       0.77      0.85      0.81        40
            5       0.63      0.76      0.69        29
            6       0.69      0.82      0.75        33
            7       0.90      0.74      0.81        47

        accuracy                           0.70       289
    macro avg       0.70      0.70      0.70       289
    weighted avg       0.71      0.70      0.70       289
    ```

### 課題2
wav2vecモデルから特徴量を作成し、LSTMを使用して感情を分類する

#### [AITraining10-2.ipynb](./AITraining10-2.ipynb)
課題2を実施したプログラムコード

#### 結果
| No. |  精度  | やったこと、対応 |
| ---- | ---- | ---- |
| 1 | 0.62 | モデルの出力をLogSoftMaxにして、損失関数をNLLLossにした<br>DataLoaderのcollate_fnをtargetを返却するようにした|

* 出力結果
    ```
                precision    recall  f1-score   support

            0       0.25      0.39      0.30        18
            1       1.00      0.33      0.50        36
            2       0.38      0.56      0.46        41
            3       0.71      0.46      0.56        37
            4       0.64      0.89      0.75        38
            5       0.67      0.60      0.63        43
            6       0.90      0.70      0.79        37
            7       0.77      0.87      0.81        38

        accuracy                           0.62       288
    macro avg       0.66      0.60      0.60       288
    weighted avg       0.69      0.62      0.62       288
    ```
※ batch_size32のepoch80でcolabのGPUメモリ限界であった。もっとepochを増やせば高い精度が得られると思う